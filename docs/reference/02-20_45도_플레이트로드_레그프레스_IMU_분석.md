# 45° 플레이트 로드 레그프레스 — IMU 센서 횟수 측정 전문가 4명 종합 분석

> 작성일: 2026-02-20
> 목적: 피카(Fica) IMU 센서를 45° 플레이트 로드 레그프레스에 적용할 때의 기술적 분석
> 관련 문서:
> - `02-20_IMU센서_4종_비교분석_보고서.md` (센서 스펙 비교)
> - `02-20_하드웨어센서_횟수카운팅_실현가능성_조사보고서.md` (전체 실현가능성)
> - V2log `rep_counter_service.dart` (One Euro Filter + Velocity Gate 구현체)

---

## 0. 쉬운 요약

3가지 핵심 질문에 대한 초보자용 답변:

### 1. 센서가 뭘 측정하나?

센서가 기구의 움직임(가속도)을 측정해요. 기구가 올라갔다 내려왔다 하면 그게 1회.

그러니까 센서 안에는 아주 작은 "흔들림 감지기"가 들어있어요. 슬레드(원판 올려놓는 판)가 움직이면 센서도 같이 움직이고, 그 움직임의 세기와 방향을 숫자로 바꿔서 스마트폰에 보내주는 거예요.

### 2. 어디에 붙이나?

슬레드(원판 끼우는 철판) 옆면에 자석으로 찰칵 붙여요. 운동할 때 슬레드가 움직이니까 센서도 같이 움직이면서 데이터를 모으는 거예요.

그러니까 에어팟 케이스만 한 작은 기기를 슬레드 옆면에 자석으로 붙이면 끝이에요. 원판 끼우는 봉(페그) 아래쪽이라 운동할 때 방해도 안 되고, 원판 교체할 때 부딪힐 일도 없어요.

### 3. 어떻게 횟수를 세나?

올라갈 때 밀리는 힘 → 멈춤 → 내려올 때 당기는 힘. 이 패턴이 반복되면 1회, 2회, 3회... 자동으로 세는 거예요.

그러니까 센서가 보는 데이터는 물결 모양 그래프예요. 다리로 밀어올리면 "위로!" 신호, 내려오면 "아래로!" 신호. 이 물결의 꼭대기와 바닥을 세면 = 횟수. 마치 파도가 "철썩-쏴아-철썩-쏴아" 하는 걸 세는 것과 같아요.

---

## 1. 기구 구조 설명

### 45° 플레이트 로드 레그프레스란?

- **A-프레임**(역삼각형) 철제 구조물이 바닥에 고정되어 있어요
- 45도 각도로 기울어진 **레일 2개**가 위로 뻗어 있어요
- 레일 위에 **슬레드(캐리지)**가 올려져 있고, 슬레드 양쪽에 원판을 끼우는 **페그(봉)**가 있어요
- 사용자가 아래쪽 좌석에 앉아서 **발로 슬레드를 밀어올려요**
- 슬레드가 45° 레일을 따라 위아래로 이동해요

그러니까 비탈길에 놓인 "원판 실은 수레"를 다리로 밀어 올리는 운동이에요. 수레(슬레드)가 레일 위를 오르락내리락하고, 센서가 이 움직임을 감지하는 거예요.

### 핀 로드(웨이트 스택)와의 차이점

| 구분 | 핀 로드 (웨이트 스택) | 플레이트 로드 |
|------|---------------------|-------------|
| 무게 방식 | 케이블+풀리로 연결된 웨이트 스택 | 슬레드에 직접 원판 적재 |
| 이동 방향 | 수직 (웨이트 스택 위아래) | **45° 각도** (레일 따라) |
| 센서 부착 | 웨이트 스택 상단 | **슬레드 측면 프레임** |
| 진동 특성 | 적음 (가이드 포스트) | **많음** (원판 덜커덕) |
| 무게 범위 | 보통 5~200kg | **20~500kg+** (더 무거움) |
| 신호 특성 | 깔끔한 수직 가속도 | 45° 투영 계산 필요 |

그러니까 핀 로드는 "핀 꽂아서 무게 선택 → 위아래 직선 이동"이라 센서 입장에서 쉬운 조건이에요. 반면 플레이트 로드는 "원판 직접 쌓기 → 비스듬한 이동 + 원판 진동"이라 센서 입장에서 더 까다로운 조건이에요.

### ASCII 다이어그램 (측면도)

```
                     ★ 센서 여기!
                      ↓
                 ╔═══════╗ ← 슬레드 (원판 탑재)
                 ║ [20kg] ║
                 ║ [20kg] ║   원판들
                 ║ [10kg] ║
                 ╚══╤════╝
                    │   ↗ 45° 레일
                    │  ↗
                    │ ↗
                 ┌──┴───┐
                 │ 풋   │ ← 발판 (사용자가 여기 발을 올림)
                 │플레이트│
                 └──────┘
                    │
                 ┌──┴──────────┐
                 │  좌석/등받이  │ ← 사용자 여기 앉음
                 └─────────────┘
                 ═══════════════ (바닥)
```

### 1회 동작 과정

```
[시작 자세]          [밀기(컨센트릭)]      [최대 신전]          [내리기(이센트릭)]
무릎 굽힌 상태        다리를 펴면서         다리가 거의 펴짐     천천히 무릎 굽힘
슬레드 아래에          슬레드를 밀어올림     슬레드 맨 위         슬레드가 내려옴

  ╔══╗               ╔══╗                   ╔══╗              ╔══╗
  ║  ║↗              ║  ║  ↗↗               ║  ║↗↗↗           ║  ║  ↗
  ╚══╝               ╚══╝                   ╚══╝              ╚══╝
  /\                  /    \                 |    |             /\
 /  \  ← 무릎 굽힘   /      \ ← 펴는 중     |    | ← 다 펌    /  \  ← 다시 굽힘

센서: 정지            센서: +가속도           센서: 감속→정지     센서: -가속도
```

이 과정이 1회(1 rep)예요. 센서는 "올라감 → 멈춤 → 내려옴 → 멈춤" 패턴을 감지해서 1회로 카운트해요.

---

## 2. [Expert 1] 생체역학 전문가 분석

**이 전문가의 역할**: "사람이 레그프레스를 할 때 슬레드가 물리적으로 어떻게 움직이는지" 분석

### 2-1. 슬레드 운동 역학

45° 레그프레스에서 슬레드에 작용하는 유효 중력(Effective Gravity)을 계산해볼게요.

```
F_유효 = m × g × sin(45°) = m × 9.81 × 0.707

예시:
- 200kg 적재 시: 200 × 9.81 × 0.707 = 1,387N (약 141kg 무게감)
- 100kg 적재 시: 100 × 9.81 × 0.707 = 694N (약 71kg 무게감)
- 300kg 적재 시: 300 × 9.81 × 0.707 = 2,080N (약 212kg 무게감)
```

그러니까 45° 각도 때문에 실제로 밀어야 하는 힘은 적재 무게의 약 70.7%(sin 45°)예요. 200kg을 올려놨어도 실제로는 약 141kg 정도를 미는 느낌이에요. 수직으로 200kg을 들어올리는 것보다 약 30% 가벼운 셈이에요.

**이게 센서에 의미하는 것**: 사용자가 더 많은 무게를 올려놓고 운동하게 되므로, 슬레드 질량이 커서 가속도가 작아져요. 무거울수록 천천히 움직이고, 센서 신호도 약해진다는 뜻이에요.

### 2-2. 가속도 프로파일 (1회 반복 동안)

센서가 슬레드에 붙어 있을 때, 1회 동작 동안 어떤 가속도를 느끼는지 시간순으로 분석해요.

| 구간 | 시간 | 가속도 (레일축) | G-force 범위 | 쉽게 말하면 |
|------|------|----------------|-------------|-----------|
| 밀기 시작 (컨센트릭 초반) | 0.2~0.5초 | +0.5 ~ +2.0 m/s² | 1.1~1.2g | 슬레드가 "출발!" 하는 순간, 가장 큰 힘이 걸려요 |
| 밀기 중간 (등속 구간) | 0.3~0.8초 | ~0 m/s² | ~0.7g | 일정 속도로 올라가는 중 (힘 변화 적음) |
| 밀기 끝 (감속) | 0.2~0.4초 | -0.5 ~ -1.5 m/s² | 0.5~0.6g | "거의 다 올라갔다" 브레이크 걸리는 구간 |
| 전환점 (맨 위) | 0.1~0.5초 | ~0 → 부호 전환 | ~0.7g | 잠깐 멈추거나 바로 내려오는 지점 |
| 내리기 시작 (이센트릭 초반) | 0.3~0.5초 | +0.3 ~ +0.8 m/s² | 0.8~0.9g | 중력에 의해 내려오기 시작 |
| 내리기 끝 (감속) | 0.3~0.5초 | -1.0 ~ -3.0 m/s² | 0.4~0.5g | "바닥에서 잡아!" 다리로 버티는 구간 |
| **전환점 (바닥)** | 0.1~0.3초 | **급격한 부호 반전** | **1.5~2.5g 스파이크** | **이게 "1회" 시작 신호! 가장 센 충격** |

그러니까 센서가 보는 가속도 그래프는 물결 모양이에요. 위로 밀 때 (+), 내려올 때 (-), 바닥에서 방향 바꿀 때 큰 "쿵!" 스파이크가 생겨요. 이 스파이크를 세면 = 횟수.

**1회 동작의 가속도 파형 (ASCII 그래프)**:

```
가속도
(g)
 +2.0 |         바닥 전환점 스파이크!
      |              ╱╲
 +1.0 |    밀기      ╱  ╲     밀기 시작
      |   시작 ╱╲  ╱    ╲   ╱╲
 +0.5 |  ╱╲  ╱  ╲╱      ╲ ╱  ╲
      | ╱  ╲╱              ╲    ╲
  0.0 |╱────────────────────╲────╲──── 시간
      |        ╲╱
 -0.5 |    감속  밀기 끝
      |
 -1.0 |  감속(내리기 끝)
      |
      0   0.5   1.0   1.5   2.0   2.5  3.0  3.5 (초)

      |← 밀기(컨센트릭) →|← 내리기(이센트릭) →|← 다음 렙 →|
      |    ~1.0~1.5초     |    ~1.0~1.5초      |           |
```

### 2-3. 무게별 G-force 범위

적재 무게에 따라 센서가 느끼는 가속도 크기가 달라져요. 무거울수록 느리게 움직이니까 가속도가 작아져요.

| 적재 무게 | 유효 하중 (×sin45°) | 일반적 반복 속도 | 가속도 진폭 | 센서 감지 난이도 |
|----------|-------------------|----------------|-----------|---------------|
| 20kg (빈 슬레드) | ~14kg | 빠르고 튀는 느낌 | 높음 (1~3g) | 쉬움 (대신 노이즈 주의) |
| 60kg | ~42kg | 보통 | 중간 (0.5~1.5g) | **최적 조건** |
| 100kg | ~71kg | 보통~약간 느림 | 중간 (0.4~1.0g) | 좋음 |
| 140kg | ~99kg | 조절된 속도 | 낮은 편 (0.3~0.8g) | 양호 |
| 200kg | ~141kg | 느린 편 | 낮음 (0.2~0.6g) | 약간 도전적 |
| 300kg+ | ~212kg+ | 매우 느린 | 매우 낮음 (0.1~0.3g) | **도전적** (적응형 임계값 필요) |
| 500kg+ | ~354kg+ | 극도로 느린 | 최소 (0.05~0.15g) | **어려움** (거의 정지에 가까움) |

그러니까:
- **60~200kg** = 일반 트레이닝 범위. 신호가 깨끗하고 센서가 쉽게 감지해요.
- **200~400kg** = 고급 사용자. 신호가 약해지지만 적응형 알고리즘으로 충분히 감지 가능.
- **400kg 이상** = 극소수 파워리프터. 알고리즘 튜닝이 필요하지만, 이 범위 사용자는 전체 헬스장 인구의 1% 미만이에요.

### 2-4. 템포별 영향

같은 무게라도 운동 속도(템포)에 따라 센서 신호가 크게 달라져요.

| 템포 표기법 | 설명 | 가속도 특성 | 감지 난이도 | 비고 |
|------------|------|-----------|-----------|------|
| **3-1-3** (느린) | 3초 올리고 1초 멈추고 3초 내리기 | 매우 낮은 가속도 (0.1~0.3g) | 어려움 | 근비대(근육 키우기) 목적 |
| **2-0-2** (보통) | 2초 올리고 바로 2초 내리기 | 중간 가속도 (0.3~0.8g) | **최적** | 가장 일반적인 템포 |
| **1-0-1** (폭발적) | 빠르게 밀고 천천히 내리기 | 높은 피크 (1~2g+) | 쉬움 | 파워 트레이닝 |
| **1-0-3** (이센트릭 강조) | 빠르게 밀고 3초간 천천히 내리기 | 올릴 때 높고/내릴 때 매우 낮음 | 중간 | 비대칭 신호 |
| **부분 반복** (1/4 ROM) | 짧은 거리만 이동 | 짧지만 뚜렷한 피크 | 중간 | ROM(가동범위) 짧음 |

그러니까 대부분의 사람들이 쓰는 2-0-2 템포에서 가장 잘 작동하고, 아주 느린 템포(3-1-3)에서는 신호가 약해져서 알고리즘이 좀 더 민감하게 설정되어야 해요.

**레그프레스 특이사항**: 레그프레스는 팔 운동보다 ROM(가동범위)이 크고, 1회에 걸리는 시간도 길어요 (2~4초 vs 팔운동 1~2초). 이건 센서 입장에서 좋은 거예요 — 신호가 길게 이어지니까 놓칠 확률이 낮거든요.

> **한 줄 결론**: 60~200kg 범위(일반 트레이닝)에서는 신호가 깨끗해서 정확도 95%+ 예상. 300kg 이상에서는 적응형 알고리즘이 필요하지만, 이 범위 사용자는 극소수.

---

## 3. [Expert 2] 하드웨어 엔지니어 분석

**이 전문가의 역할**: "센서를 물리적으로 어디에, 어떻게 붙일 것인가" 설계

### 3-1. 슬레드 각 부위 평가

45° 레그프레스 슬레드의 어디에 센서를 붙일 수 있는지, 각 위치를 평가해요.

| 위치 | 재질 | 자석 부착? | 평가 | 점수 |
|------|------|----------|------|------|
| **① 슬레드 측면 프레임 (원판 페그 아래)** | 용접 철판 | 가능 | **최적** — 원판 적재 방해 안 함, 직접 운동 신호 감지, 사용자 손발 안 닿음 | **10/10** |
| ② 슬레드 상단 (원판 페그 사이) | 철판 | 가능 | 원판 교체 시 간섭 우려. 20kg 원판을 끼울 때 센서에 부딪힐 수 있음 | 6/10 |
| ③ 풋 플레이트 뒷면 | 철판 또는 고무 코팅 | 고무 코팅 시 불가 | 발에 의한 진동이 심하고, 고무 코팅된 기구가 많아 자석 안 붙음 | 4/10 |
| ④ 가이드 레일 위 | 크롬 강철 (원형) | 미끄러움 | 원형 표면에 자석이 불안정하고, 레일에 바른 윤활유 때문에 미끄러짐 | 2/10 |
| ⑤ 고정 프레임 (A-프레임) | 용접 철관 | 가능 | 움직이지 않음! 진동만 간접 감지되어 정확도 떨어짐 | 5/10 |

그러니까 센서를 붙일 수 있는 곳이 5군데인데, ①번 "슬레드 측면 프레임, 원판 페그 아래"가 압도적으로 좋아요. 직접 움직이는 부위라 신호가 강하고, 사용자가 건드릴 일도 없거든요.

### 3-2. 최적 설치 위치 상세

```
슬레드 정면도 (위에서 내려다본 모습):

    [원판 페그] ─── [슬레드 프레임] ─── [원판 페그]
    ┌────┐          ┌──────────┐          ┌────┐
    │20kg│          │          │          │20kg│
    │20kg│          │ 풋플레이트 │          │20kg│
    │10kg│          │          │          │10kg│
    └────┘          └──────────┘          └────┘
                         │
         ★ 센서 ─────────┤ ← 슬레드 측면 프레임,
         (여기!)         │    원판 페그 아래,
                         │    풋 플레이트 옆
```

```
슬레드 측면도 (옆에서 본 모습):

    원판 페그 →  ───────────────
                 │ 20kg │ 20kg │
                 │ 원판  │ 원판  │  ← 원판들이 여기 끼워짐
                 ───────────────
                 │              │
    센서 여기! → ★ ■■■          │  ← 페그 아래, 슬레드 프레임 옆면
                 │              │
                 │  슬레드 본체  │
                 ────────────────
                      │  │
                    레일  레일   ← 45° 기울어진 레일 위에 올려져 있음
```

그러니까 센서는 슬레드의 **옆면**에, **원판을 끼우는 봉(페그) 아래쪽**에 자석으로 "찰칵" 붙이는 거예요. 여기는 사용자 발도 안 닿고, 원판 교체할 때도 방해 안 되는 **안전 지대**예요.

### 3-3. 자석 마운팅 사양

| 항목 | 사양 | 쉽게 말하면 |
|------|------|-----------|
| 자석 종류 | N52 네오디뮴 | 현존 가장 강력한 등급의 영구자석 |
| 자석 크기 | 직경 25mm × 2개 | 500원 동전 크기 × 2개 (안정적 고정) |
| 인력 | ~20kg (2개 합산) | 성인 남성이 양손으로 힘줘야 떼어지는 수준 |
| 보호 패드 | 실리콘 2mm | 진동 격리 + 기구 표면 보호 (흠집 방지) |
| 탈착 시간 | 2초 미만 | 착! 붙이고 후! 떼기 |
| 미끄럼 방지 | 실리콘 패드의 마찰력 | 슬레드가 위아래로 움직여도 센서가 미끄러지지 않음 |

그러니까 에어팟 케이스 크기의 센서에 강력 자석 2개가 달려 있어서, 철판 표면에 "찰칵" 하면 끝이에요. 20kg 인력이면 슬레드가 쿵쿵거려도 절대 떨어지지 않아요.

**왜 나사/볼트가 아니라 자석인가?**

| 부착 방식 | 장점 | 단점 | 판정 |
|----------|------|------|------|
| 나사/볼트 | 완벽히 고정 | 기구에 구멍 뚫어야 함 → 헬스장 거부 | 불가 |
| 양면테이프 | 저렴 | 진동에 약함, 교체 번거로움 | 보조용만 |
| 클램프 | 견고 | 슬레드 프레임 두께 다양 → 범용성 낮음 | 보조용만 |
| **자석** | 범용 (모든 철판), 즉시 탈착, 기구 무손상 | 비자성체(알루미늄, 스테인리스 일부) 불가 | **최적** |

대부분의 상업용 레그프레스 슬레드는 용접 철판(탄소강)이라 자석이 잘 붙어요. 간혹 스테인리스나 알루미늄 슬레드가 있지만, 이건 전체 기구의 5% 미만이에요.

### 3-4. ICM-45686 vs LSM6DSV 비교 (플레이트 로드 환경 특화)

이전 보고서(`02-20_IMU센서_4종_비교분석_보고서.md`)에서 4개 센서를 비교했고, 1순위 ICM-45686 / 2순위 LSM6DSV로 결론 났어요. 여기서는 **플레이트 로드 레그프레스** 환경에 특화해서 다시 비교해요.

| 요소 | ICM-45686 | LSM6DSV | 플레이트 로드 환경 승자 |
|------|-----------|---------|---------------------|
| **원판 덜커덕 진동** (100~500Hz) | BalancedGyro 내장 댐핑 | 댐핑 없음 (소프트웨어 처리 필요) | **ICM-45686** |
| **슬레드 슬램 충격** (바닥에 쿵!) | 20,000g 내성 | 10,000g 내성 | **ICM-45686** |
| **저-G 감도** (300kg+ 느린 렙) | 70 µg/√Hz | BMI270보다 낮음 (더 정밀) | LSM6DSV 약간 우세 |
| **배터리 수명** | 220µA → ~12일 (500mAh 기준) | 550µA → ~9일 (500mAh 기준) | **ICM-45686** |
| **가격** | ~$5.86 (100개) | ~$1.48 (100개) | **LSM6DSV** (4배 저렴) |
| **FIFO 버퍼** | 8KB | 4KB | **ICM-45686** (MCU 깨우는 횟수 절반) |
| **MIPI I3C 지원** | 아직 없음 | 지원 | LSM6DSV (미래 확장성) |
| **FSM 온칩 처리** | 없음 (Wake-on-Motion만) | FSM 8개 (센서 내부에서 간단한 판단 가능) | LSM6DSV (추가 배터리 절약) |

그러니까:
- **ICM-45686** = 플레이트 로드처럼 진동과 충격이 심한 기구에 더 적합. BalancedGyro 댐핑이 원판 소음을 하드웨어 레벨에서 잡아줘서 소프트웨어가 편해요.
- **LSM6DSV** = 4배 저렴하고 성능도 충분하지만, 진동 필터링을 소프트웨어에서 더 열심히 해야 해요.

> **한 줄 결론**: 플레이트 로드 기구는 진동과 충격이 핀 로드보다 많아서 **ICM-45686이 더 안전한 선택**. 비용 중시하면 LSM6DSV도 가능하지만 소프트웨어 필터링 부담 증가.

### 3-5. 진동 격리 설계

플레이트 로드 레그프레스는 핀 로드 기구보다 진동이 3가지 더 있어요.

| 진동 원인 | 주파수 대역 | 크기 | 센서에 미치는 영향 | 대처법 |
|----------|-----------|------|-----------------|--------|
| **원판 덜커덕** (운동 중 원판끼리 부딪힘) | 100~500Hz | 낮음 (0.01~0.1g) | 고주파 잡음 추가 | 센서 내부 LPF 25Hz로 100Hz 이상 잡음 완전 제거 |
| **슬레드 슬램** (세이프티 캐치에 쿵!) | 순간 충격 | 매우 높음 (1,000~5,000g) | 큰 스파이크 → 센서 손상 위험 | ICM-45686 20,000g 내성 + 실리콘 패드 충격 흡수 |
| **원판 적재/교체** (끼우거나 뺄 때) | 순간 충격 | 중간 (500~2,000g) | 가짜 "운동" 신호 발생 위험 | Velocity Gate 필터 (60ms 미만 충격 무시) |

그러니까:
- **원판 덜커덕** = 소리는 시끄럽지만 에너지는 작아요. 센서의 내장 필터(LPF 25Hz)만으로 완전히 제거돼요.
- **슬레드 슬램** = 에너지가 어마어마하지만, ICM-45686이 20,000g까지 버텨요. 실리콘 패드가 추가 완충재 역할.
- **원판 교체** = 이게 진짜 위험해요. 운동 사이에 원판을 끼울 때 센서가 "어? 움직였다!" 하고 오카운팅할 수 있거든요. 이건 소프트웨어(Velocity Gate)로 잡아요.

**실리콘 패드의 역할 (진동 전달 경로)**:

```
[슬레드 철판] → [실리콘 패드 2mm] → [자석] → [센서 하우징] → [IMU 칩]
                    ↑
              여기서 고주파 진동이
              흡수됨 (100Hz 이상)

효과:
- 100Hz 진동 → 80% 감쇠 (실리콘 패드)
- 500Hz 진동 → 95% 감쇠 (실리콘 패드)
- 운동 신호 (0.5~5Hz) → 거의 100% 통과 (영향 없음)
```

그러니까 실리콘 패드는 "고주파(빠른 떨림)는 막고, 저주파(실제 운동)는 통과시키는" 물리적 필터 역할을 해요. 스프링 없는 쿠션이라고 생각하면 돼요.

---

## 4. [Expert 3] 신호처리 전문가 분석

**이 전문가의 역할**: "센서 데이터를 어떤 알고리즘으로 처리해서 횟수를 세는가" 설계

### 4-1. 45° 축 투영 (가장 중요한 수학)

센서가 슬레드에 45° 기울어져 부착되므로, 센서의 X축과 Z축에 모두 운동 신호가 섞여 들어와요. 이걸 "레일 방향" 하나로 합쳐야 해요.

**왜 필요한가?**

```
센서가 수평으로 놓여 있으면:
- 위아래 움직임 = Z축에만 나타남 → 간단!

하지만 45° 기울어져 있으면:
- 위아래 움직임이 X축과 Z축에 반반씩 섞임 → 복잡!
- 이걸 하나로 합치는 게 "축 투영"
```

**공식**:

```
a_rail = a_x × cos(θ) + a_z × sin(θ) - g × sin(θ)

각 항목의 의미:
- a_x     = 센서 X축 가속도 (수평 성분)
- a_z     = 센서 Z축 가속도 (수직 성분)
- θ       = 레일 각도 (45° = π/4 ≈ 0.785 rad)
- g       = 중력 가속도 (9.81 m/s²)
- cos(45°) = sin(45°) = 0.707

마지막 항 "- g × sin(θ)":
- 정지 상태에서 중력 성분을 빼는 거예요
- 이걸 안 빼면 슬레드가 가만히 있어도 가속도가 0이 아니게 됨
- 빼면 정지 = 0, 움직임 = +/- 값으로 깔끔하게 나옴
```

그러니까 센서가 비스듬히 붙어있으니까, X축과 Z축 데이터를 45° 각도에 맞게 합산해서 "레일 방향 가속도"만 뽑아내는 거예요. 중력 영향도 빼서, 순수하게 "슬레드가 얼마나 빨리 움직이는지"만 남기는 계산이에요.

**숫자 예시**:

```
슬레드 정지 상태:
- a_x = 6.94 m/s² (중력의 수평 성분)
- a_z = 6.94 m/s² (중력의 수직 성분)
- a_rail = 6.94 × 0.707 + 6.94 × 0.707 - 9.81 × 0.707
        = 4.91 + 4.91 - 6.94
        = 2.88 ← 중력 잔여 (실제로는 보정으로 0에 가깝게 만듦)

슬레드 밀기 시작 (추가 +1.0 m/s² 레일 방향):
- a_rail = ... + 1.0 (운동 성분만 남음)
→ 양수 = 밀어올리는 중!

슬레드 내려오는 중 (-0.5 m/s² 레일 방향):
- a_rail = ... - 0.5 (운동 성분만 남음)
→ 음수 = 내려오는 중!
```

### 4-2. 자동 보정 (Auto-Calibration)

센서를 처음 부착하면 정확히 45°가 아닐 수 있어요. 기구마다 레일 각도가 조금씩 다르고(42°~50°), 센서를 붙이는 사람도 정확히 수평을 맞출 수 없으니까요.

**자동 보정 과정**:

```
1. 센서가 슬레드에 부착됨 (대충 붙여도 OK)

2. 자동 보정 시작 (3초 소요):
   - 슬레드 정지 상태에서 중력 벡터를 측정
   - 50Hz × 3초 = 150샘플 평균

3. 실제 기울기 각도 계산:
   θ_실제 = atan2(a_x_평균, a_z_평균)

   예: a_x = 7.1, a_z = 6.8 이면
   θ = atan2(7.1, 6.8) = 46.2° (45°에서 1.2° 틀어짐)

4. 이 θ_실제를 축 투영 공식에 대입
   → 센서를 대충 붙여도 자동으로 보정됨!

5. 보정 완료 신호: LED 초록색 1초 점등
```

그러니까 센서를 "대충" 붙여도 3초 만에 자동으로 각도를 계산해서 보정하는 거예요. 헬스장 직원이 각도기를 들고 정밀하게 붙일 필요가 전혀 없어요.

**보정이 필요한 추가 상황**:

| 상황 | 보정 동작 | 시간 |
|------|----------|------|
| 최초 부착 | 자동 (3초 정지 감지) | 3초 |
| 센서가 떨어져서 다시 붙임 | 자동 (정지 감지 후 재보정) | 3초 |
| 원판 무게 변경 (슬레드 처짐 각도 미세 변화) | 불필요 (각도 변화 < 0.5°) | 0초 |
| 다른 기구로 이동 (레일 각도 다름) | 자동 (NFC 탭 후 정지 감지) | 3초 |

### 4-3. 3단계 필터 파이프라인

```
[IMU 원시 데이터 50Hz]
    │
    ▼
[1단계: 하드웨어 LPF 25Hz]  ← 센서 내부 필터 (ICM-45686 설정)
    │                          원판 덜커덕 소음 (100~500Hz) 완전 제거
    │                          그러니까 센서 칩 안에서 고주파 잡음을 미리 걸러냄
    ▼
[2단계: One Euro Filter]    ← 소프트웨어 필터 (MCU에서 실행)
    │   파라미터:
    │   - minCutoff: 0.8    (정적 스무딩 — 정지 시 잡음 억제)
    │   - beta: 0.005       (동적 추적 — 빠른 움직임 지연 최소화)
    │   - dCutoff: 1.0      (미분 필터 — 표준값)
    │
    │   V2log rep_counter_service.dart의 값과 비교:
    │   - CV 버전:  minCutoff=1.0, beta=0.007 (각도 기반, 30fps)
    │   - IMU 버전: minCutoff=0.8, beta=0.005 (가속도 기반, 50Hz)
    │   → IMU가 좀 더 강한 스무딩 (원판 진동 대응)
    ▼
[3단계: DC 제거 HPF 0.1Hz]  ← 중력 드리프트 제거
    │                          온도 변화, 센서 드리프트로 인한
    │                          기준선(baseline) 이동을 잡아줌
    │                          그러니까 "0점이 서서히 올라가는 현상" 방지
    ▼
[깨끗한 레일축 가속도 신호]   ← 여기서 피크를 세면 = 횟수!
```

그러니까 원시 데이터에서 3단계로 잡음을 걸러내는 거예요:
1. **하드웨어 필터**: "원판 딸각거리는 소리" 같은 고주파 잡음 제거
2. **One Euro 필터**: 정지할 때는 확 잡고, 움직일 때는 살살 잡아서 "지연 없이 깔끔한 신호" 생성
3. **DC 제거 필터**: 센서가 오래 켜져 있으면 기준점이 서서히 틀어지는데, 이걸 자동으로 잡아줌

### 4-4. Peak Detection + Velocity Gate 알고리즘

V2log 카메라 기반 시스템(`rep_counter_service.dart`)에서 이미 검증된 패턴을 IMU에 적용해요. 핵심 로직은 동일하고, 입력만 "관절 각도" 대신 "레일축 가속도"로 바뀌는 거예요.

```
IMU 횟수 감지 알고리즘 (step-by-step):

Step 1: 레일축 가속도 투영 (§4-1의 공식)
  → a_rail 값 도출

Step 2: 3단계 필터 적용 (§4-3)
  → 깨끗한 a_filtered 값 도출

Step 3: Velocity Gate (움직임 판정)
  ┌─────────────────────────────────────────────────┐
  │ 가속도 변화율 = |a_filtered - a_prev| / dt      │
  │                                                  │
  │ IF 변화율 > 0.05g/sec:                          │
  │   movingFrameCount++                            │
  │   IF movingFrameCount >= 3:  (50Hz에서 60ms)    │
  │     isMoving = true   ← "진짜 움직이는 중!"      │
  │ ELSE:                                            │
  │   stationaryFrameCount++                        │
  │   IF stationaryFrameCount >= 250: (5초)          │
  │     → 피크/밸리 리셋 (세트 종료로 간주)           │
  │   movingFrameCount = 0                          │
  └─────────────────────────────────────────────────┘

  그러니까 "잠깐 흔들림"은 무시하고 "진짜 운동"만 인식해요.
  연속 3프레임(60ms) 이상 움직여야 "운동 시작"으로 판단.

Step 4: 방향 감지
  ┌───────────────────────────────┐
  │ IF a_filtered > 0:            │
  │   direction = EXTENDING       │  ← 밀기 (슬레드 올라가는 중)
  │ IF a_filtered < 0:            │
  │   direction = CONTRACTING     │  ← 내리기 (슬레드 내려오는 중)
  └───────────────────────────────┘

Step 5: 피크/밸리 추적
  ┌───────────────────────────────────────────────┐
  │ 현재 피크값 추적 (양수 최대)                     │
  │ 현재 밸리값 추적 (음수 최소)                     │
  │                                                │
  │ IF 피크에서 현재값까지 40% 이상 떨어지면:        │
  │   → 방향 전환 감지! (밀기 → 내리기)             │
  │   → 피크 리셋, 밸리 추적 시작                   │
  │                                                │
  │ EXTENDING → CONTRACTING → EXTENDING = 1회(rep) │
  └───────────────────────────────────────────────┘

  그러니까 파도의 꼭대기에서 40% 내려오면
  "방향 바뀌었다!" 고 판단하는 거예요.

Step 6: 진폭 체크 (너무 약한 신호 무시)
  ┌───────────────────────────────────────────────┐
  │ 최소 진폭: 0.08g                              │
  │ (매우 무거운 슬로우 렙에서도 이 정도는 나옴)     │
  │                                                │
  │ 적응형 임계값:                                  │
  │ - 최근 3회의 평균 진폭 × 0.3 = 동적 최소 진폭   │
  │ - 첫 운동 신호가 2.0g이면 → 다음부터 0.6g 이상  │
  │   있어야 유효한 렙으로 인정                      │
  └───────────────────────────────────────────────┘

  그러니까 "원판 끼우다가 딸각" 같은 약한 신호는
  자동으로 걸러지고, 진짜 운동 신호만 카운트돼요.

Step 7: 디바운스 (너무 빠른 연속 카운트 방지)
  ┌───────────────────────────────────────────────┐
  │ 최소 반복 간격: 1.0초                          │
  │ (레그프레스는 팔운동보다 느림)                    │
  │                                                │
  │ 최대 반복 간격: 10.0초                          │
  │ (극도로 느린 렙도 허용)                          │
  │                                                │
  │ CV 버전 비교:                                   │
  │ - rep_counter_service.dart: 최소 0.5초          │
  │ - IMU 레그프레스 버전: 최소 1.0초               │
  │ → 레그프레스 1회가 2~4초 걸리니까 여유있게 설정  │
  └───────────────────────────────────────────────┘

Step 8: 확인 시스템 (초반 오카운팅 방지)
  ┌───────────────────────────────────────────────┐
  │ 첫 2회: "확인 중" 상태 (UI에 카운트 안 보여줌)  │
  │ 3회째: 정식 카운팅 시작!                        │
  │        + 1~2회 소급 적용 (총 3회로 표시)         │
  │                                                │
  │ 왜 이렇게 하나?                                 │
  │ → 원판 교체, 자세 잡기 등의 "가짜 움직임"을     │
  │   걸러내기 위해. 진짜 운동은 3회 이상 반복되니까 │
  │   3회째부터 "아, 이건 진짜 운동이구나!" 확정.    │
  └───────────────────────────────────────────────┘
```

### 4-5. CV 시스템과 IMU 시스템 파라미터 비교

| 파라미터 | CV 버전 (rep_counter_service.dart) | IMU 레그프레스 버전 | 변경 이유 |
|---------|-----------------------------------|-------------------|----------|
| 입력 데이터 | 관절 각도 (°) | 레일축 가속도 (g) | 측정 대상 자체가 다름 |
| 샘플링 주파수 | ~7Hz (카메라 30fps, frameSkip 3) | 50Hz (IMU 직접) | IMU가 7배 빠름 → 더 정밀 |
| One Euro minCutoff | 1.0 | 0.8 | 가속도가 각도보다 노이즈 많아 강한 스무딩 |
| One Euro beta | 0.007 | 0.005 | 같은 이유 — 약간 더 보수적 |
| Velocity Gate 임계값 | 15°/sec | 0.05g/sec | 단위가 다름 (각도 → 가속도) |
| Gate 연속 프레임 | 2프레임 (286ms) | 3프레임 (60ms) | IMU가 빨라서 3프레임도 짧은 시간 |
| 방향 전환 감쇠 | 40% | 40% | 동일 — 검증된 값 유지 |
| 정지 리셋 시간 | 2초 (14프레임) | 5초 (250프레임) | 레그프레스는 세트 간 쉬는 시간이 길고, 락아웃 홀드도 있음 |
| 최소 디바운스 | 0.5초 | 1.0초 | 레그프레스 1회 = 2~4초 (팔운동보다 느림) |
| 확인 프레임 | 2회 | 2회 | 동일 — 검증된 값 유지 |

그러니까 CV 시스템에서 이미 검증된 알고리즘 뼈대를 그대로 가져와서, "레그프레스에 맞는 파라미터만 조정"하는 거예요. 바퀴를 새로 발명하는 게 아니라 타이어 사이즈만 바꾸는 것과 같아요.

### 4-6. 엣지 케이스 분석

| 엣지 케이스 | 위험도 | 설명 | 대처법 | 예상 결과 |
|------------|--------|------|--------|----------|
| **부분 반복** (1/4 ROM) | 중간 | 짧은 거리만 이동하여 진폭이 작음 | 적응형 임계값: 첫 2회 기준으로 40% 낮춤 | 88~93% 정확도 |
| **락아웃 홀드** (맨 위에서 5초+) | 낮음 | 무릎 펴고 쉬기 → 세트 종료로 오인 가능 | 정지 리셋 5초로 설정 (CV의 2초보다 김) | 문제 없음 |
| **바닥에서 바운싱** | 낮음 | 슬레드가 안전장치에 부딪혀 반동 | 디바운스 1.0초 → 0.5초 간격의 바운스 무시 | 문제 없음 |
| **원판 적재/교체** | 높음 | 운동 사이에 원판 끼울 때 가짜 신호 | Velocity Gate (60ms+) + 확인 시스템 (2회 미달 시 무시) | 오카운팅 0% |
| **인접 기구 진동** | 매우 낮음 | 옆에서 다른 사람이 기구 사용 | LPF 25Hz + 센서가 직접 부착된 슬레드만 감지 (구조물 전달 진동은 미미) | 문제 없음 |
| **한 다리 프레스** | 중간 | 한쪽 다리로만 밀기 → 비대칭 진동 | 레일축 투영에는 영향 없음 (레일 방향 가속도는 동일) | 문제 없음 |
| **와이드/내로우 스탠스 전환** | 없음 | 발 위치만 바뀜, 슬레드 이동은 동일 | 추가 처리 불필요 | 문제 없음 |
| **센서 배터리 방전** | 낮음 | 운동 중 배터리 소진 | FIFO 8KB에 마지막 ~80초 데이터 보관 → 충전 후 동기화 | 데이터 유실 최소화 |
| **결로/습기** | 매우 낮음 | 헬스장 에어컨 ↔ 체열 온도 차이 | IP54 하우징 (방수 등급 4: 모든 방향 물 튀김 보호) | 문제 없음 |

### 4-7. 예상 정확도

| 조건 | 예상 정확도 | 근거 |
|------|-----------|------|
| 60~200kg, 보통 템포 (2-0-2) | **95~98%** | 최적 조건: 신호 크고 깨끗, W8-Scope 연구에서 유사 조건 96~98% 달성 |
| 200~400kg, 느린 템포 | **90~95%** | 신호 약해지지만 적응형 임계값으로 충분히 감지 |
| 400kg+, 매우 느린 | **85~90%** | 적응형 임계값 필수. 이 범위 사용자 < 1% |
| 부분 반복 (1/4 ROM) | **88~93%** | ROM 짧지만 가속도 피크는 존재 |
| 폭발적 템포 (1-0-1) | **96~99%** | 피크가 매우 뚜렷해서 감지 쉬움 |
| 느린 템포 (3-1-3) | **88~93%** | 가속도 작지만 적응형 임계값이 자동 조정 |
| **가중 평균 (일반 헬스장)** | **93~96%** | 대부분 60~200kg 범위, 보통 템포 사용 |

그러니까:
- **일반적인 헬스장 이용 조건에서 93~96% 정확도**를 예상해요.
- 이건 V2log CV 카메라 시스템(88~95%)보다 **오히려 높아요**.
- 이유: IMU는 카메라와 달리 조명, 각도, 가림(occlusion)의 영향을 안 받고, 슬레드에 직접 붙어있어서 신호가 직접적이에요.

> **한 줄 결론**: 일반적인 헬스장 이용 조건에서 93~96% 정확도 예상. CV 카메라(88~95%)보다 오히려 높고, 알고리즘 뼈대는 이미 검증된 것을 재활용.

---

## 5. [Expert 4] UX/설치 전문가 분석

**이 전문가의 역할**: "실제 헬스장에서 누가 어떻게 설치하고 사용하는가" 설계

### 5-1. 안전 구역 다이어그램

센서를 붙여도 되는 곳 / 절대 안 되는 곳을 시각화해요.

```
╔══════════════════════════════════════════════════╗
║              원판 적재 구역                        ║
║  사용자가 20kg 원판을 들고                         ║ ← 절대 센서 금지!
║  이리저리 옮기는 영역                              ║   원판 교체 시 부딪힘
║  (원판 페그 상단~중간)                             ║
╠══════════════════════════════════════════════════╣
║                                                   ║
║             ★ 센서 안전 구역 ★                     ║
║                                                   ║
║   (슬레드 측면 프레임,                             ║ ← 여기만 OK!
║    원판 페그 아래,                                 ║   원판 적재 동선 밖
║    풋 플레이트 옆)                                 ║   사용자 발/손 안 닿음
║                                                   ║
╠══════════════════════════════════════════════════╣
║              발판 구역                             ║
║  사용자 발이 올라가는 곳                            ║ ← 절대 센서 금지!
║  (풋 플레이트 전면)                                ║   발에 차임
╠══════════════════════════════════════════════════╣
║              좌석/등받이 구역                       ║
║  (고정 프레임, A-프레임)                           ║ ← NFC 태그는 여기
║                                                   ║   앉기 전에 탭
╚══════════════════════════════════════════════════╝
```

### 5-2. NFC 태그 위치

```
사용자 접근 방향 (기구 앞으로 걸어옴)
         │
         ▼
    ┌─────────────────────┐
    │    A-프레임 상단      │
    │                     │
    │  [📱 NFC 태그] ←──── 여기 탭! (허리~가슴 높이, 서 있을 때)
    │                     │
    │    ┌───좌석────┐     │
    │    │          │     │
    │    │  사용자   │     │
    │    │  앉는 곳  │     │
    │    └──────────┘     │
    │                     │
    └─────────────────────┘
    ═════════════════════════ (바닥)
```

그러니까 사용자가 기구에 앉기 전에 옆에 서서 스마트폰을 NFC 태그에 "탭" 하는 자연스러운 동선이에요. 허리~가슴 높이에 있으니까 허리 안 굽히고 편하게 탭할 수 있어요.

**NFC 탭 후 앱 화면 흐름**:

```
[1. NFC 탭]
    │
    ▼
┌──────────────────────────────┐
│  "레그프레스 인식됨!"          │
│                              │
│  지난 기록:                   │
│  📊 180kg × 10회 × 4세트     │
│  📅 3일 전 (2/17)            │
│                              │
│  오늘 추천:                   │
│  💪 185kg × 10회 × 4세트     │
│  (점진적 과부하 +5kg)         │
│                              │
│  [운동 시작]                  │
└──────────────────────────────┘
    │
    ▼
[2. 좌석에 앉아서 운동 시작]
    │ (이 이후로는 스마트폰 조작 0)
    ▼
[3. 센서가 자동 카운팅]
    │ 1회... 2회... 3회... ...10회
    ▼
[4. 정지 5초 감지 → 세트 종료]
    │
    ▼
[5. 자동으로 다음 세트 대기]
    │ 휴식 타이머 자동 시작
    ▼
[6. 다시 움직임 감지 → 다음 세트 시작]
    │ ... (4세트 완료까지 반복)
    ▼
[7. 5분 무활동 → 운동 종료]
```

그러니까 NFC 탭 한 번이 유일한 조작이에요. 그 이후로는 센서가 알아서 횟수를 세고, 세트를 구분하고, 운동 종료까지 자동이에요. **운동 중 추가 조작 = 0** (Zero Interaction 원칙).

### 5-3. 다중 사용자 시나리오 (NFC 세션 핸드오프)

헬스장에서는 여러 사람이 같은 기구를 번갈아 써요. 센서가 "지금 누가 쓰고 있는지" 알아야 해요.

```
[사용자 A 도착]
    │
    ▼
① NFC 탭 → 앱: "레그프레스 인식됨! 지난번: 180kg × 10회 × 4세트"
    │           → 센서: "사용자 A 세션 시작!" (BLE 연결)
    │
② 운동 시작 → 센서 자동 카운팅 → 데이터는 사용자 A의 앱으로 전송
    │
③ 운동 완료 → 자리 떠남
    │
[5분 무활동 → 센서 대기 모드] (BLE 연결 해제)
    │
[사용자 B 도착]
    │
    ▼
① NFC 탭 → 앱: "레그프레스 인식됨! 지난번: 120kg × 12회 × 3세트"
    │           → 센서: "사용자 B 세션 시작!" (새 BLE 연결)
    │
② 센서가 사용자 B 세션으로 전환 → 데이터는 사용자 B의 앱으로 전송
```

**핵심**: NFC 탭이 "이 기구를 지금 내가 쓴다"는 선언이에요. 탭을 안 하면 센서는 움직임을 감지해도 데이터를 저장하지 않아요. 모르는 사람의 운동 데이터가 내 앱에 들어오는 일은 없어요.

**합운동(두 사람이 번갈아 사용) 시나리오**:

```
[사용자 A NFC 탭] → 센서: "A 세션"
    │
[A가 1세트 → 2세트 → 3세트]  ← 센서가 A 데이터로 기록
    │
[A: "형 한 세트 해"] → B가 사용하려면?
    │
[사용자 B NFC 탭] → 센서: "B 세션으로 전환!"
    │                → A 세션 자동 일시정지 (종료 아님)
    │
[B가 1세트] ← 센서가 B 데이터로 기록
    │
[사용자 A 다시 NFC 탭] → 센서: "A 세션 재개!"
    │
[A가 4세트] ← 센서가 다시 A 데이터로 기록
```

그러니까 NFC 탭만 하면 세션이 전환돼요. "합운동"(두 사람이 번갈아 쓰는 문화)에도 자연스럽게 대응할 수 있어요.

### 5-4. 유지보수 주기

| 작업 | 주기 | 담당 | 소요 시간 | 쉽게 말하면 |
|------|------|------|----------|-----------|
| 배터리 충전 | 10~12일마다 | 헬스장 직원 | 2시간 (USB-C) | 에어팟 충전하듯 USB-C 꽂기 |
| 표면 닦기 | 매일 | 헬스장 직원 | 10초 | 물티슈로 슥 한 번 |
| 위치 확인 | 주 1회 | 헬스장 직원 | 눈으로 확인 | "자석이 잘 붙어있나?" 눈으로 훑기 |
| 펌웨어 업데이트 | 월 1회 (필요시) | 자동 (BLE OTA) | 자동 | 밤에 자동으로 업데이트 (직원 개입 없음) |
| NFC 태그 교체 | 연 1회 (손상 시) | 헬스장 직원 | 30초 | 스티커 떼고 새 거 붙이기 |
| 기기 전체 교체 | 3~5년 | 피카 서비스팀 | 5분 (교환) | 고장 나면 새 거로 교체 |

그러니까 일상적인 유지보수는 "10일에 한 번 충전" + "매일 닦기"가 전부예요. 기구 50대 기준으로도 하루 4~5대만 충전하면 돼요 (돌아가면서).

**배터리 충전 동선**:

```
[직원 출근] 06:00
    │
[앱 대시보드 확인] → "배터리 20% 이하: 레그프레스 #3, 체스트프레스 #7"
    │
[해당 센서 2개 탈거] → 자석이라 2초 × 2 = 4초
    │
[충전 스테이션에 꽂기] → USB-C × 2
    │
[2시간 후 완충] → 다시 기구에 붙이기 → 4초
    │
총 소요: 약 10초 (탈거+부착) + 기다림 2시간 (다른 업무 중)
```

### 5-5. 엣지 케이스 & 대응

| 상황 | 발생 확률 | 대응 | 비고 |
|------|----------|------|------|
| **사용자가 원판 교체하다 센서에 부딪힘** | 낮음 | 센서가 페그 아래에 있어서 부딪힐 확률 낮음. 부딪혀도 IP54 하우징이 보호 | 위치 선정으로 예방 |
| **슬레드 쿵 떨어뜨림 (안전 캐치에)** | 중간 | ICM-45686 20,000g 내성. 자석 인력 20kg이라 충격에도 안 떨어짐 | 하드웨어로 해결 |
| **NFC 안 찍고 운동 시작** | 높음 | 센서가 움직임 감지하면 LED 깜빡임 + 앱 알림 "NFC 탭 해주세요" | UX 리마인더 |
| **배터리 방전 (운동 중)** | 매우 낮음 | FIFO 8KB에 마지막 ~80초 데이터 보관. 충전 후 자동 동기화 | 데이터 유실 방지 |
| **청소 직원이 센서 떼어냄** | 중간 | 다시 붙이면 Auto-Calibration으로 3초 내 복구 | 자동 보정이라 아무나 붙여도 됨 |
| **센서를 다른 기구에 잘못 붙임** | 낮음 | NFC 태그가 기구 ID를 가지고 있어서, 센서 위치와 NFC 태그 불일치 시 앱에서 경고 | NFC가 기구 식별 |
| **땀/음료수 유출** | 중간 | IP54 등급: 모든 방향 물 튀김 보호. 수건으로 닦으면 됨 | 방수 하우징 |
| **도난/분실** | 낮음 | BLE 비콘으로 위치 추적 + 앱 대시보드에서 "마지막 위치" 확인 | 소프트웨어로 추적 |
| **기구 이동/재배치** | 낮음 | 센서와 NFC 태그를 함께 옮기면 됨. Auto-Calibration 자동 실행 | 기구 이동에 무관 |

> **한 줄 결론**: 설치는 자석으로 2초, 유지보수는 12일에 한 번 충전. 운동 중 추가 조작 = 0 (Zero Interaction 원칙 준수). 대부분의 엣지 케이스는 하드웨어 또는 자동 소프트웨어로 해결.

---

## 6. 종합 결론

### 6-1. 전문가 4명 합의 사항

| 항목 | 합의 내용 | 근거 |
|------|----------|------|
| **센서 위치** | 슬레드 측면 프레임, 원판 페그 아래 | 직접 운동 신호 + 안전 구역 + 자석 부착 가능 |
| **센서 선택** | 1순위 ICM-45686, 2순위 LSM6DSV | 진동/충격 내성 + 배터리 (or 가성비) |
| **부착 방식** | N52 네오디뮴 자석 × 2 + 실리콘 패드 2mm | 범용성 + 20kg 인력 + 진동 격리 |
| **측정 원리** | 45° 축 투영 가속도 → One Euro Filter → Peak Detection | V2log CV 시스템에서 검증된 알고리즘 재활용 |
| **예상 정확도** | 93~96% (가중 평균) | 60~200kg 범위 95~98%, 200kg+ 범위 90~95% |
| **유지보수** | 10~12일 충전, IP54 하우징 | 500mAh 배터리 + ICM-45686 220µA |
| **UX** | NFC 탭 1회 → 이후 완전 자동 | Zero Interaction 원칙 |

### 6-2. 플레이트 로드 vs 핀 로드: 난이도 비교

| 요소 | 핀 로드 (웨이트 스택) | 플레이트 로드 (레그프레스) | 차이 |
|------|---------------------|-------------------------|------|
| 이동 방향 | 수직 (단순) | 45° (축 투영 필요) | 플레이트 로드가 좀 더 복잡 |
| 진동 | 적음 | 원판 덜커덕 (추가 필터링 필요) | 플레이트 로드가 노이즈 많음 |
| 충격 | 보통 | 슬레드 슬램 (높은 충격 내성 필요) | 플레이트 로드가 더 가혹 |
| 무게 범위 | 5~200kg | 20~500kg+ | 플레이트 로드가 극단값 넓음 |
| 자석 부착 | 웨이트 스택 상단 (철판) | 슬레드 측면 (철판) | 둘 다 가능 |
| 예상 정확도 | 95~98% | **93~96%** | 플레이트 로드가 2~3% 낮지만 충분 |
| **전체 난이도** | **쉬움** | **중간 (하지만 충분히 가능)** | |

그러니까 플레이트 로드 레그프레스는 핀 로드 기구보다 센서 입장에서 2~3% 정도 더 어렵지만, 알고리즘과 하드웨어가 충분히 대응 가능해요. "불가능"이 아니라 "약간의 추가 엔지니어링"이 필요한 수준이에요.

### 6-3. 검증 체크리스트

실제 헬스장에서 검증해야 할 항목들:

| # | 검증 항목 | 합격 기준 | 테스트 방법 |
|---|----------|----------|-----------|
| 1 | 60~200kg에서 정확도 | 95%+ | 10명 × 5세트 × 10회 = 500회 수동 카운트 비교 |
| 2 | 200~400kg에서 정확도 | 90%+ | 5명 × 3세트 × 8회 = 120회 수동 카운트 비교 |
| 3 | 30초 휴식 중 오카운팅 | 0건 / 100세트 | 100세트 연속 테스트, 휴식 중 카운트 발생 여부 |
| 4 | 원판 교체 중 오카운팅 | 0건 / 50회 | 50회 원판 교체 시뮬레이션 |
| 5 | 3가지 템포 (느림/보통/빠름) | 모두 85%+ | 각 템포 × 3세트 × 10회 |
| 6 | 자석 마운트 내구성 | 500회 탈착 후 이상 없음 | 반복 탈착 테스트 |
| 7 | 슬레드 슬램 내구성 | 1,000회 후 센서 정상 | 안전장치까지 떨어뜨리는 테스트 |
| 8 | Auto-Calibration 속도 | 3초 이내 | 10회 부착 → 보정 시간 측정 |
| 9 | 다중 사용자 전환 | 오할당 0건 / 50회 | A→B→A 번갈아 NFC 탭 |
| 10 | 합운동 시나리오 | 세션 혼동 0건 | A-B-A-B 패턴 테스트 |

### 6-4. 핵심 리스크 & 완화 전략

| 리스크 | 확률 | 영향 | 완화 전략 |
|--------|------|------|----------|
| 300kg+ 에서 정확도 미달 | 중간 | 낮음 (사용자 < 5%) | 적응형 임계값 + 자이로 보조 데이터 활용 |
| 비자성체 슬레드 (알루미늄) | 낮음 | 중간 | 별도 클램프 어댑터 제공 |
| 센서 도난 | 낮음 | 중간 | BLE 추적 + 대시보드 알림 |
| 사용자 NFC 안 찍음 | 높음 | 낮음 | LED 깜빡임 + 앱 알림 + 습관화 유도 |
| 원판 소음이 예상보다 심함 | 중간 | 중간 | 하드웨어 LPF 대역폭 조정 (25Hz → 15Hz) |

### 6-5. 참고문헌

| 자료 | 내용 | 활용 |
|------|------|------|
| TDK ICM-45686 데이터시트 | 센서 스펙, 전력, 충격 내성 | §3 하드웨어 설계 |
| ST LSM6DSV 데이터시트 | 센서 스펙, FSM, I3C | §3 비교 분석 |
| Pinto et al. (PMC 9112713) | Leg Press Velocity and Muscle Activation | §2 가속도 프로파일 근거 |
| Samozino et al. | Force-velocity relationship in leg press | §2 무게별 속도 데이터 |
| W8-Scope (Microsoft Research) | 웨이트 스택 IMU 부착 횟수 카운팅 | §4 정확도 벤치마크 |
| LiftRight (NSF) | Quantifying strength training with wearable sensor | §4 알고리즘 참고 |
| Accelerometer-Based Automated Counting (Hindawi) | 가속도 기반 운동 카운팅 알고리즘 | §4 Peak Detection 설계 |
| V2log `rep_counter_service.dart` | One Euro Filter + Velocity Gate 구현체 | §4 파라미터 매핑 |
| `02-20_IMU센서_4종_비교분석_보고서.md` | 4개 IMU 센서 상세 비교 | §3 센서 선정 |
| `02-20_하드웨어센서_횟수카운팅_실현가능성_조사보고서.md` | 전체 실현가능성 종합 조사 | 전체 맥락 |

---

> **최종 한 줄 결론**: 45° 플레이트 로드 레그프레스에 ICM-45686 IMU 센서를 자석으로 부착하면, 일반 트레이닝 조건에서 93~96% 횟수 감지 정확도를 달성할 수 있으며, 운동 중 사용자 조작은 0회. 기존 V2log CV 시스템의 검증된 알고리즘을 파라미터만 조정하여 재활용 가능.
